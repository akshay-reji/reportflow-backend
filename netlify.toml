[build]
  command = "npm install"
  publish = "."

[build.environment]
  NODE_ENV = "production"

[functions]
  directory = "netlify/functions"

# API routes - redirect to our server function
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/server/:splat"
  status = 200

# Health check specific route
[[redirects]]
  from = "/api/health"
  to = "/.netlify/functions/server/api/health"
  status = 200

# Scheduler routes
[[redirects]]
  from = "/api/scheduler/*"
  to = "/.netlify/functions/server/api/scheduler/:splat"
  status = 200

# Reporter routes
[[redirects]]
  from = "/api/reporter/*"
  to = "/.netlify/functions/server/api/reporter/:splat"
  status = 200

# Email routes
[[redirects]]
  from = "/api/email/*"
  to = "/.netlify/functions/server/api/email/:splat"
  status = 200

# OAuth GA routes - ðŸ†• ADD THIS CRITICAL MISSING ROUTE
[[redirects]]
  from = "/api/oauth/ga/*"
  to = "/.netlify/functions/server/api/oauth/ga/:splat"
  status = 200

# Debug routes
[[redirects]]
  from = "/api/debug-routes"
  to = "/.netlify/functions/server/api/debug-routes"
  status = 200

# Root route - ðŸ†• ADD THIS FOR BETTER UX
[[redirects]]
  from = "/"
  to = "/.netlify/functions/server"
  status = 200